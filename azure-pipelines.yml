# Python Function App to Linux on Azure
# Build a Python function app and deploy it to Azure as a Linux function app.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/python

trigger:
- master

variables:

  # Agent VM image name
  vmImageName: 'ubuntu:18.04'

  # Working Directory
  workingDirectory: '$(System.DefaultWorkingDirectory)/'

stages:
- stage: Build
  displayName: Build stage

  jobs:
    - template: azure-pipelines-build-template.yml

- stage: DeployDEV
  displayName: Deploy to dev environment
  dependsOn: Build
  condition: succeeded()
  variables:
    - group: webalerts-dev-vargroup

  jobs:
    - template: azure-pipelines-deploy-template.yml
      parameters:
        azureSub: '$(AzureConnectionName)'
        funcAppName: '$(FunctionAppName)'
        environment: 'development'